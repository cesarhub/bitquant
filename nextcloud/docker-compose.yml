version:  '3'
services:
  nextcloud:
     image: "joequant/nextcloud"
     build:
       context: .
       dockerfile: Dockerfile
     ports:
       - 80:80
       - 443:443
     volumes:
       - lib:/var/lib/nextcloud
       - etc:/etc/nextcloud
     restart: always
     depends_on:
       - db
  db:
      image: postgres:12-alpine
      restart: always
      environment:
       - POSTGRES_PASSWORD:mypass
      volumes:
       - db:/var/lib/postgresql/data
      restart: always

volumes:
   lib:
   db:
   etc:
